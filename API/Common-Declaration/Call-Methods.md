# Calling Method #
## Basic Instruction on Calling ##

JD Cloud OpenAPI uses the Restful style interface. The following information needs to be included to call OpenAPI: Request protocol, request mode, request address, request path, request header, request parameter and request body.

It is recommended to use the https for your data security.

Different interfaces of JD Cloud OpenAPI use different HTTP methods. POST requests are used to create general resources, GET requests are used for query, PUT or PATCH requests re used for modification, and DELETE requests are used for deleting. For the HTTP method used for specific interfaces, please refer to the chapters and sections of API document request mode.

The address and path format of OpenAPI service are usually as follows:

	https://{product}.jdcloud-api.com/{API version number} /regions/\ {region ID}/{resource name}/{resource ID(optional)}/{sub-resource name(optional)}/{sub-resource ID(optional)}{: customized action (optional)}

For the address and path of each interface, please refer to the chapters and sections of API document request address.

The HTTP request header should include a public request header. Please refer to the public request header.

For information about request parameters and request bodies, please refer to the chapters and sections for API document request parameter. Generally speaking, the interface parameters of GET, DELETE and HEADER are passed by request parameters, and the interface parameters of POST, PUT and PATCH are passed by request bodies.

## Public Request Header ##

Name|Type|Not Null|Description
:---|:---|:---|:---
x-jdcloud-algorithm | String | Yes | is used to create a hash algorithm for requesting signature, which currently only supports `JDCLOUD2-HMAC-SHA256`
x-jdcloud-date | String | Yes | refers to the date and time of signature request, which abides by ISO8601 Standard, based on the UTC time in the format of YYYYMMDDTHHmmssZ. The date must match with the date used in the `authorization` request header. E.g: `20180707T150456Z`
x-jdcloud-nonce | String | Yes |refers to a randomly generated string that needs to remain unique for a certain period of time
x-jdcloud-security-token | String | No | refers to that if the user opens mfa operation protection while such API interface needs protection, then this parameter needs to be passed when calling
authorization | String | Yes | refers to authentication information, which is generated by the signature algorithm, with the generated data, with the format of, for example: JDCLOUD2-HMAC-SHA256    Credential=accessKey/20180226/cn-north-1/nc/jdcloud2_request,    SignedHeaders=content-type;host;x-jdcloud-date;x-jdcloud-nonce,    Signature=4432ad80f84a41d56f3d41b59918a0844b468d8c131fa7d7c993693f62cf43ef`



## Instructions on Parameters of Special Requests ##       

Some of the API interfaces use special request parameters, for example, the describeInstances interface of the VM uses filters parameter in the following way:

Parameter Name|Use Scenario|Function|Example
:---|:---|:---|:---
filters.N | is used in list request as a filter condition | query condition, for querying interface, with the following format: Filters.N. Each condition of the query conditions, must include name,values, operator as filled in optionally, default eq, optionallt,   le, gt, gt, ne, in, like (In case of no special instruction on API, the operator needs not to be filled in and is eq by default) | For example, query based on name, CIDR and cpus: filters.1.name=name&filters.1.values.1=aaa&filters.2.name=CIDR&filters.2.values.1=192.168.1.0/24&filters.3.name=cpus&filters.3.operator=in&filters.3.values.1=2&filters.3.values.2=4;
Sorts.N | is used in the list request, as a sorting condition | Sorting parameter, with the format of sorts.N | sorts.1.name=az&sorts.1.direction=asc&sorts.2.name=status&sorts.2.direction=desc;



## GET Request Example ##        

The following is an example of calling the query of VM list interface, to introduce how a GET type OpenAPI call is generated. (As direct construction of an OpenAPI call is relatively more cumbersome, it is recommended that you directly use the SDK provided by JD Cloud)

Firstly, on the VM interface overview page, you can see the request address of the VM and the specific interface describeInstances that created the VM.

Then on the describeInstances page, you see that the request method is GET, the request address is /v1/regions/{regionId}/instances, and you can also see the request parameters. regionId is queried by region code. All the parameters of GET, DELETE and HEAD request are passed in the form of request parameters.

The finally generated call is:

	GET
	https://vm.jdcloud-api.com/v1/regions/cn-north-1/instances?pageNumber=1&pageSize=25

Request Header:

	x-jdcloud-algorithm: JDCLOUD2-HMAC-SHA256
	x-jdcloud-date: 20140707T150456Z
	x-jdcloud-nonce: ed558a3b-9808-4edb-8597-187bda63a4f2
	authorization: JDCLOUD2-HMAC-SHA256 accessKey/20180226/cn-north-1/nc/jdcloud2_request, SignedHeaders=content-type;host;x-jdcloud-date;x-jdcloud-nonce, Signature=4432ad80f84a41d56f3d41b59918a0844b468d8c131fa7d7c993693f62cf43ef

Request Body:

	Blank

 

## POST Request Example ##    

The following is an example of calling the VM creation interface, to introduce how a POST type OpenAPI call is generated. (As direct construction of an OpenAPI call is relatively more cumbersome, it is recommended that you directly use the SDK provided by JD Cloud)

Firstly, on the VM interface overview page, you can see the request address of the VM and the specific interface createInstances that created the VM.

Then on the createInstances page, you see that the request method is POST, the request address is /v1/regions/{regionId}/instances, and you can also see the request parameters. regionId is queried by region code. All parameters requested by POST, PUT, and PATCH are passed as json strings through the requesting body.

The finally generated call is:

	POST
	https://vm.jdcloud-api.com/v1/regions/cn-north-1/instances

Request Header:

	x-jdcloud-algorithm: JDCLOUD2-HMAC-SHA256
	x-jdcloud-date: 20140707T150456Z
	x-jdcloud-nonce: ed558a3b-9808-4edb-8597-187bda63a4f2
	authorization: JDCLOUD2-HMAC-SHA256 accessKey/20180226/cn-north-1/nc/jdcloud2_request, SignedHeaders=content-type;host;x-jdcloud-date;x-jdcloud-nonce, Signature=4432ad80f84a41d56f3d41b59918a0844b468d8c131fa7d7c993693f62cf43ef

Request Body:

	{
         "instanceSpec": {
                  "az": "cn-north-1a",
                  "instanceType": "g.s1.micro",
                  "imageId": "98d4a0f-88c1-451a-8971-f1f76903b6c",
                  "name": "sdk-test",
                  "elasticIp": {
                          "bandwidthMbps": 2,
                          "provider": "NO_BGP"
                  },
                  "primaryNetworkInterface": {
                          "networkInterface": {
                                   "subnetId": "subnet-0rtcw9jl0",
                                   "az": "cn-north-1a"
                          }
                  },
                  "systemDisk": {
                          "diskCategory": "local"
                  },
                  "dataDisks": [{
                          "diskCategory": "cloud",
                          "autoDelete": true,
                          "cloudDiskSpec": {
                                   "name": "sdk-test-disk1",
                                   "diskType": "premium-hdd",
                                   "diskSizeGB": 50
                          }
                  },
                  {
                          "diskCategory": "cloud",
                          "autoDelete": true,
                          "cloudDiskSpec": {
                                   "name": "sdk-test-disk2",
                                   "diskType": "ssd",
                                   "diskSizeGB": 40
                          }
                  }],
                  "description": "sdk test"
         },
         "maxCount": 2,
         "regionId": "cn-north-1"
	}
