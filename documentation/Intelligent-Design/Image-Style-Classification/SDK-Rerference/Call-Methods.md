# Call Method #
## Call Base Description ##

JD Cloud OpenAPI uses Restful API style, the following information needs to be included to perform OpenAPI call: request protocol, request method, request address, request path, request header, request parameter, request body.

For your data security, it is recommended that you must use the https protocol.

Different APIs of JD Cloud OpenAPI use different HTTP methods, resource creation generally uses POST request, search uses GET request, modification uses PUT or PATCH request, deletion uses DELETE request. For the HTTP method used by specific API, please refer to API document, request method chapter.

Generally, the address and path format for OpenAPI Service are:

	https://{product}.jdcloud-api.com/{API version number}/regions/{region ID}/{resource name}/{resource ID(optional)}/{sub-resource name(optional)}/{sub-resource ID(optional)}{:customized action(optional)}

For the address and path of each API, please refer to API document, request address chapter.

HTTP request header needs to include the public request header, please refer to the public request header.

For the information in the request parameter and request body, please refer to specific API document, request parameter chapter. Generally speaking, API parameters of GET, DELETE and HEADER are passed through request parameter, API parameters of POST, PUT and PATCH are passed through request body.

## Public Request Header ##

Name | Type | Compulsory | Description
:---|:---|:---|:---
x-jdcloud-algorithm | String | Yes  | Hash algorithm used to create request signatures, currently only supports `JDCLOUD2-HMAC-SHA256`
x-jdcloud-date | String | Yes | The date and time of signature request shall be subject to ISO8601, with the UTC time with the format of YYYYMMDDTHHmmssZ. The date must match the date used in the `authorization` request header. For example: `20180707T150456Z`
x-jdcloud-nonce | String | Yes | The uniqueness of character string generated randomly shall be guaranteed in a certain time
x-jdcloud-security-token | String | No | If user enables mfa operation protection, the API is the API requiring protection, the parameter shall be transmitted upon call
authorization | String | Yes | Authentication information, generated by signature algorithm, the format of generated data format is as follows, such as: JDCLOUD2-HMAC-SHA256    Credential=accessKey/20180226/cn-north-1/nc/jdcloud2_request,    SignedHeaders=content-type;host;x-jdcloud-date;x-jdcloud-nonce,    Signature=4432ad80f84a41d56f3d41b59918a0844b468d8c131fa7d7c993693f62cf43ef`



## Special Request Parameter Description ##       

Certain APIs use some special request parameters, such as the describeInstances API of Virtual Machines uses filters parameter, with the use method as follows:

Parameter Name|Customer Scenario|Effect|Example
:---|:---|:---|:---
filters.N | In the list request, as the filter conditions | Search conditions, for search API   with the format as, Filters.N.search conditions, each condition must include name,values, optional operator, eq by default, optional lt,   le, gt, gt, ne, in, like (without special description for API, no need to fill in operator, eq by default) | If searched according to name, CIDR and cpus: filters.1.name=name&filters.1.values.1=aaa&filters.2.name=CIDR&filters.2.values.1=192.168.1.0/24&filters.3.name=cpus&filters.3.operator=in&filters.3.values.1=2&filters.3.values.2=4;
Sorts.N | In the list request, as the sorting condition  | Sort parameter, the format is sorts.N | sorts.1.name=az&sorts.1.direction=asc&sorts.2.name=status&sorts.2.direction=desc;



## GET Request Example ##        

Take the call and search list API of Virtual Machines as the example, introduce how to produce an OpenAPI call of GET type. (Constructing OpenAPI calls directly is tedious, it is strongly suggested that you shall directly uses SDK provided by JD Cloud)

At first, on the Virtual Machines API Overview Page, you can see the request address of Virtual Machines and specific API describeInstances for creating VM instances.

On the describeInstances page, you can see the request method as GET, request address as /v1/regions/{regionId}/instances as well as request parameter. regionId can be obtained by region coding search. All parameters for GET, DELETE, and HEAD requests are passed as request parameters.

The finally generated call is:

	GET
	https://vm.jdcloud-api.com/v1/regions/cn-north-1/instances?pageNumber=1&pageSize=25

Request Head:

	x-jdcloud-algorithm: JDCLOUD2-HMAC-SHA256
	x-jdcloud-date: 20140707T150456Z
	x-jdcloud-nonce: ed558a3b-9808-4edb-8597-187bda63a4f2
	authorization: JDCLOUD2-HMAC-SHA256 accessKey/20180226/cn-north-1/nc/jdcloud2_request, SignedHeaders=content-type;host;x-jdcloud-date;x-jdcloud-nonce, Signature=4432ad80f84a41d56f3d41b59918a0844b468d8c131fa7d7c993693f62cf43ef

Request Body:

	Blank

 

## POST Request Example ##    

Take the call creation API of Virtual Machines as the example, introduce how to produce an OpenAPI call of POST type. (Constructing OpenAPI calls directly is tedious, it is strongly suggested that you shall directly uses SDK provided by JD Cloud)

At first, on the Virtual Machines API Overview Page, you can see the request address of Virtual Machines and specific API createInstances for creating VM instances.

On the createInstances page, you can see the request method as POST, request address as /v1/regions/{regionId}/instances as well as request parameter. regionId can be obtained by region coding search. All parameters for POST, PUT, PATCH requests are passed through request body in json string.

The finally generated call is:

	POST
	https://vm.jdcloud-api.com/v1/regions/cn-north-1/instances

Request Head:

	x-jdcloud-algorithm: JDCLOUD2-HMAC-SHA256
	x-jdcloud-date: 20140707T150456Z
	x-jdcloud-nonce: ed558a3b-9808-4edb-8597-187bda63a4f2
	authorization: JDCLOUD2-HMAC-SHA256 accessKey/20180226/cn-north-1/nc/jdcloud2_request, SignedHeaders=content-type;host;x-jdcloud-date;x-jdcloud-nonce, Signature=4432ad80f84a41d56f3d41b59918a0844b468d8c131fa7d7c993693f62cf43ef

Request Body:

	{
         "instanceSpec": {
                  "az": "cn-north-1a",
                  "instanceType": "g.s1.micro",
                  "imageId": "98d4a0f-88c1-451a-8971-f1f76903b6c",
                  "name": "sdk-test",
                  "elasticIp": {
                          "bandwidthMbps": 2,
                          "provider": "NO_BGP"
                  },
                  "primaryNetworkInterface": {
                          "networkInterface": {
                                   "subnetId": "subnet-0rtcw9jl0",
                                   "az": "cn-north-1a"
                          }
                  },
                  "systemDisk": {
                          "diskCategory": "local"
                  },
                  "dataDisks": [{
                          "diskCategory": "cloud",
                          "autoDelete": true,
                          "cloudDiskSpec": {
                                   "name": "sdk-test-disk1",
                                   "diskType": "premium-hdd",
                                   "diskSizeGB": 50
                          }
                  },
                  {
                          "diskCategory": "cloud",
                          "autoDelete": true,
                          "cloudDiskSpec": {
                                   "name": "sdk-test-disk2",
                                   "diskType": "ssd",
                                   "diskSizeGB": 40
                          }
                  }],
                  "description": "sdk Test"
         },
         "maxCount": 2,
         "regionId": "cn-north-1"
	}
